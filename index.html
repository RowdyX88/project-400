
<!doctype html>
<!-- BuildByer - Updated: 2025-09-04 03 -->
<html lang="en">
  <head>
    <meta charset="utf-8" />
    <meta name="viewport" content="width=device-width, initial-scale=1" />
  <title>BuildByer</title>
  <meta name="application-name" content="BuildByer" />
  <meta name="apple-mobile-web-app-title" content="BuildByer" />
  <meta name="description" content="BuildByer — interactive map, timeline, and insights across NATO, politics, weather, life and global events." />
  <meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
  <link rel="canonical" href="https://buildbyer.com/" />
  <link rel="stylesheet" href="/assets/styles.css?v=dev5513" />
  <!-- Leaflet.js for map panel -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet@1.9.4/dist/leaflet.css" />
  <script src="https://unpkg.com/leaflet@1.9.4/dist/leaflet.js"></script>
  <!-- Leaflet.markercluster for clustering support -->
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.css" />
  <link rel="stylesheet" href="https://unpkg.com/leaflet.markercluster@1.5.3/dist/MarkerCluster.Default.css" />
  <script src="https://unpkg.com/leaflet.markercluster@1.5.3/dist/leaflet.markercluster.js"></script>
  <!-- App icons / favicon -->
  <!-- Modern SVG favicon (preferred) -->
  <link rel="icon" href="/assets/icons/favicon.svg?v=2025-09-04" type="image/svg+xml" />
  <!-- Safari pinned tab (monochrome SVG) -->
  <link rel="mask-icon" href="/assets/icons/safari-pinned-tab.svg?v=2025-09-04" color="#fbbf24" />
  <link rel="icon" type="image/x-icon" href="/assets/icons/favicon.ico?v=2025-09-04" />
  <link rel="shortcut icon" href="/assets/icons/favicon.ico?v=2025-09-04" />
  <link rel="icon" type="image/png" sizes="32x32" href="/assets/icons/favicon-32x32.png?v=2025-09-04" />
  <link rel="icon" type="image/png" sizes="16x16" href="/assets/icons/favicon-16x16.png?v=2025-09-04" />
  <link rel="apple-touch-icon" sizes="180x180" href="/assets/icons/apple-touch-icon.png?v=2025-09-04" />
  <link rel="manifest" href="/site.webmanifest?v=2025-09-04" />
  <meta name="msapplication-config" content="/assets/icons/browserconfig.xml?v=2025-09-04" />
  <meta name="msapplication-TileColor" content="#0f172a" />
  <meta name="theme-color" content="#0f172a" />
  <!-- Open Graph / Twitter -->
  <meta property="og:type" content="website" />
  <meta property="og:title" content="BuildByer" />
  <meta property="og:site_name" content="BuildByer" />
  <meta property="og:description" content="Interactive map, timeline, and insights across NATO, politics, weather, life and global events." />
  <meta property="og:url" content="https://buildbyer.com/" />
  <meta property="og:image" content="https://buildbyer.com/assets/og/buildbyer-1200x630.png" />
  <meta property="og:image:width" content="1200" />
  <meta property="og:image:height" content="630" />
  <meta name="twitter:card" content="summary_large_image" />
  <meta name="twitter:title" content="BuildByer" />
  <meta name="twitter:description" content="Interactive map, timeline, and insights across NATO, politics, weather, life and global events." />
  <meta name="twitter:image" content="https://buildbyer.com/assets/og/buildbyer-1200x630.png" />
  <!-- JSON-LD: Organization + Website -->
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "Organization",
    "name": "BuildByer",
    "url": "https://buildbyer.com/",
  "logo": "https://buildbyer.com/assets/icons/apple-touch-icon.png?v=2025-09-04"
  }
  </script>
  <script type="application/ld+json">
  {
    "@context": "https://schema.org",
    "@type": "WebSite",
    "name": "BuildByer",
    "url": "https://buildbyer.com/"
  }
  </script>
  <link rel="stylesheet" href="src/ui/layout.css" />
  </head>
  <body class="bg-blue-950 text-blue-100 min-h-screen">
  <div id="app" class="relative min-h-screen w-full">
      <!-- Desktop top strip: shown on >= 481px; mirrors mobile actions -->
      <div id="desktop-pre-strip" class="desktop-pre-strip" role="navigation" aria-label="Quick actions">
        <a href="#" class="mps-title mps-title-link" role="link" title="Home">REALITY</a>
        <div class="mps-actions">
          <a class="mps-btn" href="#fa-goals" title="Open FA/FO Goals & Bills">FA/FO Goals & Bills</a>
          <a class="mps-btn" href="#buildbyer" title="Open BuildByer">BuildByer</a>
          <a class="mps-btn" href="#contact" aria-controls="contact-modal" aria-expanded="false" title="Open contact">Contact</a>
        </div>
      </div>
      <!-- Phone-only top strip: left title + action pills -->
      <div id="mobile-pre-strip" class="mobile-pre-strip" role="navigation" aria-label="Quick actions">
        <a href="#" class="mps-title mps-title-link" role="link" title="Home">REALITY</a>
        <div class="mps-actions">
          <a class="mps-btn" href="#fa-goals" title="Open FA/FO Goals & Bills">FA/FO Goals & Bills</a>
          <a class="mps-btn" href="#buildbyer" title="Open BuildByer">BuildByer</a>
          <a id="contact-tab" class="mps-btn" href="#contact" aria-controls="contact-modal" aria-expanded="false" title="Open contact">Contact</a>
        </div>
      </div>
      <!-- Floating draggable left panel -->
  <div id="left-panel" class="draggable panel glassy left-panel">
        <!-- Left panel will be rendered by JS -->
      </div>
      <!-- Floating draggable map panel -->
  <div id="map-panel" class="draggable panel glassy map-panel">
        <h2 class="text-amber-300 font-bold mb-2">Map</h2>
        <div id="map-container">
          <!-- Phone-only overlays: category micro-dock and insights chip -->
          <div id="cat-dock" class="cat-dock" aria-label="Categories dock"></div>
          <button id="insights-chip" class="insights-chip" aria-expanded="false" aria-controls="insights-panel" title="Open insights">Insights</button>
        </div>
  <!-- Phone-only brand row under the map (contact moved to top strip) -->
        <div id="brand-row" class="brand-row" aria-label="BuildByer brand and contact">
          <button id="brand-badge" class="brand-badge" type="button" aria-controls="contact-modal" aria-expanded="false" title="Open contact">
            <img src="assets/icons/apple-touch-icon.png" alt="" width="16" height="16" />
            <span>BuildByer</span>
          </button>
        </div>
      </div>
      <!-- Insights panel (mirrors timeline, fetches web context) -->
  <div id="insights-panel" class="draggable panel glassy">
        <h2 class="text-cyan-300 font-bold mb-2">Insights</h2>
  <div id="insights-content"></div>
      </div>
      <!-- Timeline panel below -->
  <div id="timeline-panel" class="draggable panel glassy timeline-panel">
        <h2 class="text-amber-300 font-bold mb-2">Timeline</h2>
        <div class="filmstrip" id="timeline-strip"></div>
        <div id="year-row" class="year-row mt-2">
          <span id="year-min" class="year-end">1900</span>
          <div id="year-slider-wrap" class="year-slider-wrap">
            <input id="year-slider" type="range" min="1900" max="2025" value="1949" step="1" title="Select year" class="slider w-full" />
            <div id="year-tooltip" class="year-tooltip">1949</div>
          </div>
          <span id="year-max" class="year-end">2025</span>
        </div>
        <div id="year-readout" class="year-readout mt-2">1949</div>
      </div>
  <!-- (Deprecated) bottom mobile dock is kept for fallback but hidden by default -->
  <div id="mobile-dock" class="mobile-dock" aria-hidden="true"></div>
  <!-- Phone page overlay for hash routes (#fafo, #buildbyer, #contact) -->
  <div id="page-overlay" class="page-overlay" aria-hidden="true" role="dialog" aria-modal="true">
    <div class="overlay-header" role="navigation" aria-label="Page header">
      <a href="#" class="mps-title" aria-hidden="false">REALITY</a>
      <div class="mps-actions">
  <a class="mps-btn" href="#fa-goals" title="Open FA/FO Goals & Bills">FA/FO Goals & Bills</a>
  <a class="mps-btn" href="#buildbyer" title="Open BuildByer">BuildByer</a>
  <a class="mps-btn" href="#contact" aria-controls="contact-modal" aria-expanded="false" title="Open contact">Contact</a>
      </div>
    </div>
    <div class="overlay-body">
      <div id="overlay-canvas" class="overlay-card" role="region" aria-label="Page content"></div>
    </div>
  </div>
  </div>
  <script type="module" src="dist/main.js?v=dev5513"></script>
    <script>
    // Simple drag-and-drop for .draggable panels (disabled on small screens)
    document.addEventListener('DOMContentLoaded', () => {
  const mq = window.matchMedia('(max-width: 768px)');
  const mqCompact = window.matchMedia('(max-width: 900px)');
      const mqPhone = window.matchMedia('(max-width: 480px)');
      const app = document.getElementById('app');
      const left = document.getElementById('left-panel');
      const insights = document.getElementById('insights-panel');
    const dock = document.getElementById('mobile-dock');
    const insightsChip = document.getElementById('insights-chip');
      // Ensure Insights height visually matches the first row (map/contact) on phones
  const syncInsightsHeight = () => {
        try {
          if (!insights) return;
          if (!mqPhone.matches) {
            // Clear inline overrides off-phone
            insights.style.removeProperty('height');
            insights.style.removeProperty('max-height');
    insights.style.removeProperty('margin-bottom');
            return;
          }
          const mapPanel = document.getElementById('map-panel');
          if (!mapPanel) return;
          // Measure the current first row height (map + contact row)
          const rowH = Math.round(mapPanel.getBoundingClientRect().height);
          if (rowH && rowH > 0) {
    // Make Insights a bit taller than map without growing the row: add small delta and overlap with negative margin
            const delta = Math.max(42, Math.min(90, Math.round(rowH * 0.36))); // ~36% taller, capped 42–90px
    insights.style.setProperty('height', (rowH + delta) + 'px', 'important');
    insights.style.setProperty('max-height', (rowH + delta) + 'px', 'important');
    insights.style.setProperty('margin-bottom', (-delta) + 'px', 'important');
          }
        } catch {}
      };
      const updateResponsiveMode = () => {
        if (mq.matches) {
          document.body.classList.add('mobile');
        } else {
          document.body.classList.remove('mobile');
        }
        // Toggle phone mode features
        if (mqPhone.matches) {
          app && app.classList.add('phone');
      // We use top-right insights chip + left micro-dock; hide bottom dock
      dock && (dock.style.display = 'none');
          left && left.classList.remove('show');
          insights && insights.classList.remove('show');
        } else {
          app && app.classList.remove('phone');
      dock && (dock.style.display = 'none');
          // Ensure drawers not overlaying when leaving phone mode
          left && left.classList.remove('show');
          insights && insights.classList.remove('show');
        }
        // Invalidate Leaflet map size after layout changes
        setTimeout(() => {
          try {
            if (window.L && window.L.DomUtil) {
              const el = document.getElementById('leaflet-map');
              const mapEl = el && window.L.DomUtil.get('leaflet-map');
              if (mapEl && mapEl._leaflet_map) {
                mapEl._leaflet_map.invalidateSize();
              }
            }
          } catch {}
        }, 150);
        // After layout settles, sync insights height on phone
        setTimeout(syncInsightsHeight, 180);
      };
  mq.addEventListener('change', updateResponsiveMode);
  mqCompact.addEventListener('change', updateResponsiveMode);
      mqPhone.addEventListener('change', updateResponsiveMode);
      updateResponsiveMode();
      // Keep insights height in sync on resize/orientation
      window.addEventListener('resize', () => setTimeout(syncInsightsHeight, 120));
      window.addEventListener('orientationchange', () => setTimeout(syncInsightsHeight, 220));

      // Insights chip interaction (phone)
      if (insightsChip) insightsChip.addEventListener('click', () => {
        if (!insights) return;
        const show = !insights.classList.contains('show');
        insights.classList.toggle('show', show);
        insightsChip.setAttribute('aria-expanded', show ? 'true' : 'false');
        insightsChip.textContent = show ? 'Close' : 'Insights';
        // hide the left drawer if it was open
        left && left.classList.remove('show');
  updateResponsiveMode();
  setTimeout(syncInsightsHeight, 160);
      });
      // Contact modal wiring
  const contactTab = document.getElementById('contact-tab');
  const contactModal = document.getElementById('contact-modal');
  const brandBadge = document.getElementById('brand-badge');
      const closeBtn = contactModal ? contactModal.querySelector('.contact-close') : null;
      function openContact() {
        if (!contactModal) return;
        contactModal.classList.add('show');
        contactModal.setAttribute('aria-hidden', 'false');
        if (contactTab) contactTab.setAttribute('aria-expanded', 'true');
        if (brandBadge) brandBadge.setAttribute('aria-expanded', 'true');
      }
      function closeContact() {
        if (!contactModal) return;
        contactModal.classList.remove('show');
        contactModal.setAttribute('aria-hidden', 'true');
        if (contactTab) contactTab.setAttribute('aria-expanded', 'false');
        if (brandBadge) brandBadge.setAttribute('aria-expanded', 'false');
      }
  if (contactTab) contactTab.addEventListener('click', (e) => { e.preventDefault(); if (location.hash !== '#contact') location.hash = '#contact'; else route(); });
      if (brandBadge) brandBadge.addEventListener('click', (e) => {
        e.preventDefault();
        // On all screens, navigate to #contact and let router open overlay
        if (location.hash !== '#contact') location.hash = '#contact'; else route();
      });
      if (closeBtn) closeBtn.addEventListener('click', closeContact);
      if (contactModal) contactModal.addEventListener('click', (e) => {
        var t = e.target;
        if (t && t.classList && t.classList.contains('contact-backdrop')) closeContact();
      });
      // If landing with #contact, route will open overlay consistently
      if (location.hash === '#contact') {
        // no-op here; route() below handles it across viewports
      }
      window.addEventListener('keydown', (e) => { if (e.key === 'Escape') closeContact(); });
      
      // Initialize navigation immediately
      (function initializeNavigation() {
        console.log('Initializing navigation...');
        
        // Get elements
        const pageOverlay = document.getElementById('page-overlay');
        const overlayCanvas = document.getElementById('overlay-canvas');
        
        if (!pageOverlay || !overlayCanvas) {
          console.error('Navigation elements not found!', { pageOverlay, overlayCanvas });
          return;
        }
        
        console.log('Navigation elements found, setting up event listeners...');
        
        // Intercept clicks on both strips so routing happens without page jump
        const navButtons = document.querySelectorAll('#desktop-pre-strip .mps-btn, #mobile-pre-strip .mps-btn, .page-overlay .mps-btn');
        console.log('Found navigation buttons:', navButtons.length);
        
        navButtons.forEach(a => {
        a.addEventListener('click', (e) => {
          const href = a.getAttribute('href') || '';
          if (href.startsWith('#')) {
            e.preventDefault();
            if (location.hash !== href) location.hash = href; else route();
          }
        });
      });
      // Make REALITY title act as Home (clears overlay)
      document.querySelectorAll('.mps-title-link').forEach(a => {
        a.addEventListener('click', (e) => {
          e.preventDefault();
          if (location.hash) {
            history.replaceState(null, '', location.pathname + location.search);
          }
          route();
        });
      });
      function renderOverlay(route) {
        console.log('renderOverlay called with route:', route);
        const overlayCanvas = document.getElementById('overlay-canvas');
        if (!overlayCanvas) {
          console.error('overlayCanvas not found!');
          return;
        }
        console.log('overlayCanvas found, rendering content...');
        // Clear per route to allow future content
        overlayCanvas.innerHTML = '';
        if (route === 'contact') {
          overlayCanvas.innerHTML = `
            <div class="overlay-content" style="padding:10px 12px;">
              <h3 class="overlay-title" style="margin:0 0 6px 0; font-size:14px; font-weight:800; color:#fbbf24;">Contact</h3>
              <p class="overlay-copy" style="font-size:12px; line-height:1.35; color:#cbd5e1;">
                Hey, welcome to the circus.<br><br>
                BuildByer is where history, politics, and global WTF moments get butchered, roasted, and pinned to a timeline so savage your grandpa’s war medals will start sweating.<br><br>
                Got a correction? A missing fact? Some spicy year-stamped chaos that deserves eternal mockery? Drop it like a bomb at <a class="overlay-link" href="mailto:therowdyson@gmail.com" style="color:#93c5fd; text-decoration:underline;">therowdyson@gmail.com</a> — your rumor, leak, or cursed headline might just become immortal here.<br><br>
                And listen: this beast is open-source. That means you can fork it, clone it, tear it apart, or sprinkle your genius stupidity all over GitHub. Submit your pull requests, file savage issues, or straight up volunteer if you’re crazy enough to co-pilot this time-machine of doom. Repo’s open, code’s free, and your contribution will live forever (until the servers melt).<br><br>
                <strong>In short:</strong><br><br>
                Send facts or WTF events → email me.<br>
                Suggest wild features → email or scream into the void.<br>
                Want to build? → I’ll hand you the repo link, you fork, branch, push, pull, boom.<br>
                Just wanna lurk? → Download it, run it, show your grandma.<br><br>
                So yeah, hit me up: <a class="overlay-link" href="mailto:therowdyson@gmail.com" style="color:#93c5fd; text-decoration:underline;">therowdyson@gmail.com</a>.<br><br>
                History’s a mess, let’s make it even messier — together.
              </p>
            </div>`;
        }
        if (route === 'fa-goals') {
          overlayCanvas.innerHTML = `
            <div class="overlay-content" style="padding:20px; height:100%; display:flex; flex-direction:column; gap:16px;">
              <h3 class="overlay-title" style="margin:0; font-size:18px; font-weight:800; color:#fbbf24; text-align:center;">FA/FO Goals & Bills</h3>
              
              <!-- Top horizontal panel: Continents (editable) -->
              <div class="continent-panel" style="background:rgba(30,41,59,0.85); border:1px solid #334155; border-radius:12px; padding:16px; box-shadow:0 8px 32px rgba(0,0,0,0.35); backdrop-filter:blur(8px); min-height:60px;">
                <h4 style="margin:0 0 12px 0; font-size:14px; font-weight:700; color:#34d399; text-align:center; border-bottom:1px solid #34d399; padding-bottom:4px;">Continents</h4>
                <div class="continent-input-container" style="display:flex; flex-wrap:wrap; gap:8px; justify-content:center; align-items:center;">
                  <input type="text" placeholder="North America" style="background:rgba(15,23,42,0.8); border:1px solid #475569; border-radius:6px; padding:6px 12px; color:#e2e8f0; font-size:12px; min-width:120px;" />
                  <input type="text" placeholder="South America" style="background:rgba(15,23,42,0.8); border:1px solid #475569; border-radius:6px; padding:6px 12px; color:#e2e8f0; font-size:12px; min-width:120px;" />
                  <input type="text" placeholder="Europe" style="background:rgba(15,23,42,0.8); border:1px solid #475569; border-radius:6px; padding:6px 12px; color:#e2e8f0; font-size:12px; min-width:120px;" />
                  <input type="text" placeholder="Asia" style="background:rgba(15,23,42,0.8); border:1px solid #475569; border-radius:6px; padding:6px 12px; color:#e2e8f0; font-size:12px; min-width:120px;" />
                  <input type="text" placeholder="Africa" style="background:rgba(15,23,42,0.8); border:1px solid #475569; border-radius:6px; padding:6px 12px; color:#e2e8f0; font-size:12px; min-width:120px;" />
                  <input type="text" placeholder="Australia" style="background:rgba(15,23,42,0.8); border:1px solid #475569; border-radius:6px; padding:6px 12px; color:#e2e8f0; font-size:12px; min-width:120px;" />
                  <input type="text" placeholder="Antarctica" style="background:rgba(15,23,42,0.8); border:1px solid #475569; border-radius:6px; padding:6px 12px; color:#e2e8f0; font-size:12px; min-width:120px;" />
                </div>
              </div>

              <!-- Main three panels (middle section) -->
              <div class="goals-panels" style="display:flex; gap:20px; flex:1; justify-content:center; align-items:stretch; max-width:1200px; margin:0 auto; width:100%; min-height:300px;">
                <div class="goals-panel" style="flex:1; background:rgba(30,41,59,0.85); border:1px solid #334155; border-radius:12px; padding:20px; box-shadow:0 8px 32px rgba(0,0,0,0.35); backdrop-filter:blur(8px); display:flex; flex-direction:column;">
                  <h4 style="margin:0 0 16px 0; font-size:16px; font-weight:700; color:#fbbf24; text-align:center; border-bottom:2px solid #fbbf24; padding-bottom:8px;">FA Goals</h4>
                  <div style="flex:1; color:#e2e8f0; font-size:14px; line-height:1.6;">
                    <p>Financial Assistance Goals and objectives will be displayed here.</p>
                    <p>This panel contains information about FA-related initiatives, targets, and progress tracking.</p>
                    <ul style="margin:16px 0; padding-left:20px;">
                      <li>Goal tracking and metrics</li>
                      <li>Resource allocation</li>
                      <li>Performance indicators</li>
                      <li>Strategic objectives</li>
                    </ul>
                  </div>
                </div>
                <div class="goals-panel" style="flex:1; background:rgba(30,41,59,0.85); border:1px solid #334155; border-radius:12px; padding:20px; box-shadow:0 8px 32px rgba(0,0,0,0.35); backdrop-filter:blur(8px); display:flex; flex-direction:column;">
                  <h4 style="margin:0 0 16px 0; font-size:16px; font-weight:700; color:#60a5fa; text-align:center; border-bottom:2px solid #60a5fa; padding-bottom:8px;">Middle One</h4>
                  <div style="flex:1; color:#e2e8f0; font-size:14px; line-height:1.6;">
                    <p>Central coordination and overview panel.</p>
                    <p>This middle section provides integrated insights and connections between FA Goals and FO Bills.</p>
                    <ul style="margin:16px 0; padding-left:20px;">
                      <li>Cross-functional analysis</li>
                      <li>Integration points</li>
                      <li>Workflow coordination</li>
                      <li>Status summaries</li>
                    </ul>
                  </div>
                </div>
                <div class="goals-panel" style="flex:1; background:rgba(30,41,59,0.85); border:1px solid #334155; border-radius:12px; padding:20px; box-shadow:0 8px 32px rgba(0,0,0,0.35); backdrop-filter:blur(8px); display:flex; flex-direction:column;">
                  <h4 style="margin:0 0 16px 0; font-size:16px; font-weight:700; color:#f87171; text-align:center; border-bottom:2px solid #f87171; padding-bottom:8px;">FO Bills</h4>
                  <div style="flex:1; color:#e2e8f0; font-size:14px; line-height:1.6;">
                    <p>Financial Operations Bills and legislative tracking.</p>
                    <p>This panel manages FO-related bills, legislation, and regulatory compliance.</p>
                    <ul style="margin:16px 0; padding-left:20px;">
                      <li>Bill tracking and status</li>
                      <li>Legislative updates</li>
                      <li>Compliance monitoring</li>
                      <li>Regulatory changes</li>
                    </ul>
                  </div>
                </div>
              </div>

              <!-- Bottom horizontal panel: Year Slider (1900-2025) -->
              <div class="year-panel" style="background:rgba(30,41,59,0.85); border:1px solid #334155; border-radius:12px; padding:16px; box-shadow:0 8px 32px rgba(0,0,0,0.35); backdrop-filter:blur(8px); min-height:80px;">
                <h4 style="margin:0 0 12px 0; font-size:14px; font-weight:700; color:#c084fc; text-align:center; border-bottom:1px solid #c084fc; padding-bottom:4px;">Year Range (1900 - 2025)</h4>
                <div class="year-slider-container" style="display:flex; align-items:center; gap:12px; max-width:800px; margin:0 auto;">
                  <span style="color:#cbd5e1; font-size:12px; font-weight:600; min-width:40px;">1900</span>
                  <div style="flex:1; position:relative;">
                    <input 
                      type="range" 
                      id="fa-year-slider" 
                      min="1900" 
                      max="2025" 
                      value="1950" 
                      step="1"
                      style="width:100%; height:8px; background:linear-gradient(to right, #c084fc 0%, #c084fc 40%, #334155 40%, #334155 100%); border-radius:4px; appearance:none; cursor:pointer; outline:none;"
                    />
                    <div id="fa-year-tooltip" style="position:absolute; top:-32px; left:40%; transform:translateX(-50%); background:rgba(2,6,23,0.9); color:#c084fc; font-size:11px; font-weight:700; padding:4px 8px; border-radius:6px; border:1px solid #c084fc; white-space:nowrap; pointer-events:none;">1950</div>
                  </div>
                  <span style="color:#cbd5e1; font-size:12px; font-weight:600; min-width:40px;">2025</span>
                </div>
                <div style="text-align:center; margin-top:8px;">
                  <span style="color:#c084fc; font-size:13px; font-weight:700;">Selected Year: </span>
                  <span id="fa-selected-year" style="color:#e2e8f0; font-size:13px; font-weight:600;">1950</span>
                </div>
              </div>
            </div>
            <style>
              /* Custom slider styling */
              #fa-year-slider::-webkit-slider-thumb {
                appearance: none;
                width: 20px;
                height: 20px;
                background: #c084fc;
                border: 2px solid #1e293b;
                border-radius: 50%;
                cursor: pointer;
                box-shadow: 0 2px 8px rgba(192,132,252,0.4);
              }
              #fa-year-slider::-moz-range-thumb {
                width: 20px;
                height: 20px;
                background: #c084fc;
                border: 2px solid #1e293b;
                border-radius: 50%;
                cursor: pointer;
                box-shadow: 0 2px 8px rgba(192,132,252,0.4);
              }
              @media (max-width: 768px) {
                .goals-panels { flex-direction: column !important; }
                .goals-panel { min-height: 200px !important; }
                .continent-input-container { flex-direction: column !important; }
                .continent-input-container input { min-width: 200px !important; }
              }
            </style>
            <script>
              // Year slider functionality
              const slider = document.getElementById('fa-year-slider');
              const tooltip = document.getElementById('fa-year-tooltip');
              const selectedYear = document.getElementById('fa-selected-year');
              
              if (slider && tooltip && selectedYear) {
                const updateSlider = () => {
                  const value = slider.value;
                  const percent = ((value - slider.min) / (slider.max - slider.min)) * 100;
                  
                  // Update tooltip position and text
                  tooltip.style.left = percent + '%';
                  tooltip.textContent = value;
                  selectedYear.textContent = value;
                  
                  // Update slider background gradient
                  slider.style.background = 
                    'linear-gradient(to right, #c084fc 0%, #c084fc ' + percent + '%, #334155 ' + percent + '%, #334155 100%)';
                };
                
                slider.addEventListener('input', updateSlider);
                slider.addEventListener('mousemove', updateSlider);
                
                // Initialize
                updateSlider();
              }
            </script>`;
        }
      }
      function setActiveNav(h) {
        const links = document.querySelectorAll('.mps-actions a');
        links.forEach(a => {
          const isActive = (a.getAttribute('href') || '') === h;
          a.classList.toggle('active', !!isActive);
          if (isActive) a.setAttribute('aria-current', 'page'); else a.removeAttribute('aria-current');
        });
      }
      function route() {
        const h = location.hash;
        console.log('Routing to:', h);
        const pageOverlay = document.getElementById('page-overlay');
        const overlayCanvas = document.getElementById('overlay-canvas');
        
        setActiveNav(h || '');
        if (h === '#contact') {
          console.log('Opening contact modal');
          closeContact();
          pageOverlay && pageOverlay.classList.add('show');
          renderOverlay('contact');
          return;
        }
        if (h === '#fa-goals' || h === '#buildbyer') {
          console.log('Opening overlay for:', h.slice(1));
          closeContact();
          if (pageOverlay) {
            pageOverlay.classList.add('show');
            console.log('Added show class to overlay');
          } else {
            console.error('pageOverlay not found!');
          }
          renderOverlay(h.slice(1));
          return;
        }
        // default/home
        console.log('Going to home/default');
        pageOverlay && pageOverlay.classList.remove('show');
        closeContact();
      }
      window.addEventListener('hashchange', route);
      // Run once on load
      setTimeout(route, 0);
      
      // Force check current hash immediately
      if (location.hash === '#fa-goals') {
        console.log('FA Goals page detected, forcing overlay display');
        const overlay = document.getElementById('page-overlay');
        if (overlay) {
          overlay.classList.add('show');
          renderOverlay('fa-goals');
        }
      }
      
      // Add test button to manually trigger overlay
      const testButton = document.createElement('button');
      testButton.textContent = 'TEST OVERLAY';
      testButton.style.cssText = 'position:fixed; top:10px; right:10px; z-index:9999; padding:8px; background:red; color:white; border:none; cursor:pointer;';
      testButton.onclick = function() {
        console.log('Test button clicked - forcing overlay');
        const overlay = document.getElementById('page-overlay');
        const canvas = document.getElementById('overlay-canvas');
        if (overlay && canvas) {
          overlay.classList.add('show');
          canvas.innerHTML = '<div style="padding:20px; color:white;">TEST OVERLAY WORKING!</div>';
        }
      };
      document.body.appendChild(testButton);
      
      console.log('Navigation initialization complete!');
      })(); // End IIFE
      
      // Remove transform from timeline panel for proper drag/resize
      const timelinePanel = document.getElementById('timeline-panel');
      if (timelinePanel) {
    timelinePanel.style.transform = '';
    timelinePanel.style.bottom = '';
    timelinePanel.style.zIndex = 100;
      }
  // Skip drag/resize on small screens for better UX
  if (!(mq.matches || mqCompact.matches)) document.querySelectorAll('.draggable').forEach(panel => {
        let isDragging = false, startX = 0, startY = 0, origX = 0, origY = 0;
        panel.addEventListener('mousedown', e => {
            if (e.button !== 0) return;
            // Prevent drag if clicking inside map container
            if (panel.id === 'map-panel' && e.target && (e.target.id === 'leaflet-map' || e.target.closest && e.target.closest('#leaflet-map'))) return;
            // Only drag if not clicking on input, textarea, button, select, or resize handle
            var tag = e.target && e.target.tagName ? e.target.tagName.toLowerCase() : "";
            if (["input","textarea","button","select","option","label"].indexOf(tag) !== -1 || (e.target.classList && e.target.classList.contains('resize-handle'))) return;
            // Only drag if not clicking inside a contenteditable element
            if (e.target && (e.target.isContentEditable || (e.target.closest && e.target.closest('[contenteditable="true"]')))) return;
            isDragging = true;
            startX = e.clientX;
            startY = e.clientY;
            origX = panel.offsetLeft;
            origY = panel.offsetTop;
            panel.style.zIndex = 100;
            document.body.style.userSelect = 'none';
            e.preventDefault();
        });
        window.addEventListener('mousemove', e => {
          if (!isDragging) return;
          let dx = e.clientX - startX;
          let dy = e.clientY - startY;
          panel.style.left = (origX + dx) + 'px';
          panel.style.top = (origY + dy) + 'px';
        });
        window.addEventListener('mouseup', () => {
          if (isDragging) {
            isDragging = false;
            panel.style.zIndex = 20;
            setTimeout(() => { document.body.style.userSelect = ''; }, 0);
          }
        });
        // Add resize handle
        const resize = document.createElement('div');
  resize.className = 'resize-handle';
  resize.style.userSelect = 'none';
        resize.style.position = 'absolute';
        resize.style.right = '0';
        resize.style.bottom = '0';
  resize.style.width = '20px';
  resize.style.height = '20px';
        resize.style.background = 'linear-gradient(135deg, #FFC300 40%, #1e293b 60%)';
        resize.style.cursor = 'nwse-resize';
        resize.style.borderRadius = '0 0 12px 0';
  resize.style.boxShadow = '0 0 0 1px rgba(255,255,255,0.25) inset, 0 2px 8px rgba(0,0,0,0.35)';
  resize.style.zIndex = '9999';
  panel.appendChild(resize);
        let isResizing = false, startW = 0, startH = 0;
        resize.addEventListener('mousedown', e => {
          e.stopPropagation();
          isResizing = true;
          startX = e.clientX;
          startY = e.clientY;
          startW = panel.offsetWidth;
          startH = panel.offsetHeight;
          panel.style.zIndex = 101;
          document.body.style.userSelect = 'none';
          e.preventDefault();
        });
        window.addEventListener('mousemove', e => {
          if (!isResizing) return;
          let dw = e.clientX - startX;
          let dh = e.clientY - startY;
          // Apply width/height while honoring computed CSS min sizes
          const cs = window.getComputedStyle(panel);
          const minW = parseFloat(cs.minWidth) || 180;
          const minH = parseFloat(cs.minHeight) || 120;
          const newW = Math.max(minW, startW + dw);
          const newH = Math.max(minH, startH + dh);
          panel.style.width = newW + 'px';
          panel.style.height = newH + 'px';
          // If resizing map panel, resize map container and Leaflet map
          if (panel.id === 'map-panel') {
            const mapContainer = panel.querySelector('#map-container');
            if (mapContainer) {
              mapContainer.style.height = Math.max(120, panel.offsetHeight - 60) + 'px';
              mapContainer.style.width = '100%';
              // Resize Leaflet map if present
              const leafletMap = mapContainer.querySelector('#leaflet-map');
              if (leafletMap && window.L && window.L.DomUtil && window.L.DomUtil.get('leaflet-map') && window.L.DomUtil.get('leaflet-map')._leaflet_map) {
                setTimeout(() => {
                  window.L.DomUtil.get('leaflet-map')._leaflet_map.invalidateSize();
                }, 50);
              }
            }
          }
        });
        window.addEventListener('mouseup', () => {
          if (isResizing) {
            isResizing = false;
            panel.style.zIndex = 20;
            setTimeout(() => { document.body.style.userSelect = ''; }, 0);
          }
        });
  });
    });
    </script>
    <!-- Contact modal -->
    <div id="contact-modal" class="contact-modal" role="dialog" aria-modal="true" aria-hidden="true" aria-labelledby="contact-title">
      <div class="contact-backdrop"></div>
      <div class="contact-panel">
        <button class="contact-close" aria-label="Close">×</button>
        <h3 id="contact-title">Contact</h3>
        <p class="contact-copy">
          Hi! BuildByer is a tiny lab of world bits — some sharp, some shaky. Got fixes, leads,
          or year-stamped nuggets? Ping <a href="mailto:therowdyson@gmail.com">therowdyson@gmail.com</a>.
          Want to help build? I’ll share the repo and we’ll branch like it’s spring.
        </p>
      </div>
    </div>
    <style>
  /* Desktop contact overlay on brand logo */
  .left-panel .brand-header .contact-overlay,
  .brand-img-wrap .contact-overlay {
    display: none !important; /* overlay removed in favor of inline button */
  }
  @media (max-width: 480px) {
    .brand-img-wrap .contact-overlay { display: none !important; }
  }
  /* New inline contact button between logo and categories (desktop/tablet) */
  .contact-inline { font-size: 11.5px; padding: 5px 10px; border-radius: 999px; background:#1d4ed8; color:#e5e7eb; border:1px solid #1e3a8a; box-shadow: 0 2px 8px rgba(0,0,0,0.24); }
  .contact-inline:hover { filter: brightness(1.05); }
  /* Brand row (hidden by default; shown on phone) */
  .brand-row { display: none; align-items: center; justify-content: space-between; gap: 8px; margin: 4px 2px 0 2px; }
  .brand-logo { font-weight: 800; font-size: 14px; color: #fbbf24; letter-spacing: 0.3px; }
  .brand-badge { display:flex; align-items:center; gap:6px; padding: 2px 6px; border-radius: 10px; background: rgba(2,6,23,0.5); border:1px solid rgba(148,163,184,0.25); color:#fbbf24; font-weight:800; font-size: 12px; }
  .brand-badge img { border-radius: 4px; display:block; }
  .contact-tab { font-size: 10px; padding: 4px 8px; border-radius: 999px; background:#1d4ed8; color:#e5e7eb; border:1px solid #1e3a8a; box-shadow: 0 2px 8px rgba(0,0,0,0.24); white-space: nowrap; }
  .contact-tab:hover { filter: brightness(1.05); }

  /* Contact modal */
  .contact-modal { position: fixed; inset: 0; display: none; z-index: 1000; }
  .contact-modal.show { display: block; }
  .contact-modal .contact-backdrop { position: absolute; inset: 0; background: rgba(2,6,23,0.6); -webkit-backdrop-filter: blur(2px); backdrop-filter: blur(2px); }
  .contact-modal .contact-panel { position: relative; margin: 10vh auto 0; width: min(520px, 92vw); background: linear-gradient(160deg, #0b1220 0%, #0f172a 60%, #111827 100%); color:#e5e7eb; border:1px solid #334155; border-radius: 14px; box-shadow: 0 16px 48px rgba(0,0,0,0.55); padding: 14px 16px 16px; }
  .contact-modal .contact-close { position: absolute; top: 6px; right: 8px; background: transparent; color: #cbd5e1; font-size: 18px; line-height: 1; border: none; cursor: pointer; }
  .contact-modal h3 { margin: 0 0 6px 0; font-size: 14px; font-weight: 800; color: #fbbf24; }
  .contact-modal .contact-copy { font-size: 12px; line-height: 1.35; color:#cbd5e1; }
  .contact-modal a { color: #93c5fd; text-decoration: underline; }
  /* Compact Leaflet popup (global) */
  .bb-popup .leaflet-popup-content-wrapper {
    padding: 4px 6px; border-radius: 10px; max-width: 200px;
    background: rgba(2,6,23,0.95); /* slate-950 w/ opacity */
    color: #e5e7eb; /* slate-200 */
    border: 1px solid #334155; /* slate-700 */
    box-shadow: 0 6px 18px rgba(0,0,0,0.45);
  }
  .bb-popup .leaflet-popup-content { margin: 2px 0; font-size: 9.5px; line-height: 1.2; max-height: 120px; overflow: auto; word-wrap: break-word; overflow-wrap: anywhere; }
  .bb-popup .leaflet-popup-content p, .bb-popup .leaflet-popup-content li { font-size: 9.5px; line-height: 1.2; margin: 2px 0; }
  .bb-popup .leaflet-popup-content b { font-size: 10px; }
  .bb-popup .leaflet-popup-tip { width: 7px; height: 7px; background: rgba(2,6,23,0.95); border: 1px solid #334155; }
  .bb-popup .leaflet-popup-content a { color: #93c5fd; }
  .leaflet-container a.leaflet-popup-close-button { color: #cbd5e1; text-shadow: none; }

  /* Structured popup inner styles */
  .bb-popup .bbp { font-size: 9.5px; line-height: 1.2; }
  .bb-popup .bbp .bb-title { font-size: 10px; font-weight: 600; margin: 0 0 2px 0; color: #fef3c7; }
  .bb-popup .bbp .bb-meta { font-size: 9px; color: #94a3b8; margin: 0 0 2px 0; }
  .bb-popup .bbp .bb-summary { font-size: 9.5px; color: #e2e8f0; }
  .bb-popup .bbp .bb-warn { font-size: 9px; color: #f59e0b; margin-top: 2px; }
  html, body { max-width: 100dvw; }
  body {
        background: linear-gradient(120deg, #0f172a 60%, #1e293b 100%);
      }
      .glassy {
        background: rgba(30,41,59,0.85);
        box-shadow: 0 8px 32px rgba(0,0,0,0.35);
        border-radius: 18px;
  -webkit-backdrop-filter: blur(8px);
  backdrop-filter: blur(8px);
        border: 1.5px solid rgba(255,255,255,0.08);
      }
      .panel {
        /* Slightly tighter padding on desktop to reduce overall footprint */
        padding: 20px 16px;
        min-height: 100px;
        transition: box-shadow 0.2s, transform 0.2s;
      }
  /* Hide phone-only strip by default (non-phone) */
  .mobile-pre-strip { display: none; }
      .draggable {
        cursor: move;
      }
      .left-panel {
        min-width: 220px;
        max-width: 320px;
      }
      .timeline-panel {
        min-width: 400px;
      }
      .filmstrip {
        display: flex;
        flex-direction: row;
        gap: 10px;
        overflow-x: auto;
        padding: 12px;
        background: transparent;
        border-radius: 12px;
        border: 1px solid rgba(255,255,255,0.07);
        min-height: 68px;
      }
      .event-chip { 
        display: flex;
        flex-direction: column;
        padding: 12px;
        min-width: 200px;
        max-width: 260px;
        background: rgba(30,41,59,0.92); /* like category panel */
        border-radius: 12px;
        box-shadow: 0 4px 14px rgba(0,0,0,0.18);
        border: 1px solid #334155;
        transition: transform 0.16s, box-shadow 0.16s, border-color 0.16s, background 0.16s, color 0.16s;
        cursor: pointer;
        position: relative;
        color: #cbd5e1; /* default text like category list */
      }
      .event-chip::before {
        content: "";
        position: absolute; left: 0; right: 0; top: 0; height: 3px;
        border-top-left-radius: 12px; border-top-right-radius: 12px;
        background: #fbbf24; /* amber accent like category */
      }
      .event-chip:hover { transform: translateY(-2px); box-shadow: 0 10px 22px rgba(0,0,0,0.28); background: rgba(51,65,85,0.98); border-color: #475569; }
      .event-chip.active { background: #fbbf24; border-color: #fbbf24; color: #1e293b; box-shadow: 0 0 0 2px rgba(251,191,36,0.5); }
      /* Text inside chips matching category palette */
  .chip-title { margin-top: 6px; font-size: 13px; font-weight: 700; color: #fbbf24; line-height: 1.3; }
      .event-chip.active .chip-title { color: #1e293b; }
      .chip-summary { margin-top: 6px; font-size: 12px; color: #cbd5e1; line-height: 1.5; }
      .event-chip.active .chip-summary { color: #0b1220; }
      .chip-tags { margin-top: 8px; display:flex; gap:6px; flex-wrap: wrap; }
      .chip-tag { font-size: 11px; color:#e5e7eb; background:#1f2937; border:1px solid #475569; padding:2px 6px; border-radius: 999px; }
      .event-chip.active .chip-tag { color:#1e293b; background:#fde68a; border-color:#f59e0b; }
      .chip-year { font-size: 11px; font-weight: 800; color: #e5e7eb; background:#1f2937; border:1px solid #475569; padding: 2px 6px; border-radius: 999px; }
      .event-chip.active .chip-year { color:#1e293b; background:#fff7d6; border-color:#f59e0b; }
      .category {
        padding: 8px 10px; /* tighter on desktop */
        border-radius: 10px;
        cursor: pointer;
        margin-bottom: 6px; /* less vertical space */
        background: rgba(30,41,59,0.92);
        color: #fbbf24;
        font-size: 16px;
        font-weight: 500;
        border: 1px solid #334155;
        transition: background 0.18s, color 0.18s;
      }
      .category.active {
        background: #fbbf24;
        color: #1e293b;
        font-weight: 700;
      }
      #year-slider {
        width: 100%;
      }
      .year-readout {
        font-weight: 600;
        text-align: right;
        color: #fbbf24;
        font-size: 18px;
      }
    #map-panel {
      display: flex;
      flex-direction: column;
      min-height: 400px;
      height: 480px; /* down from 520 to fit typical laptop view */
    }
      #map-container {
      flex: 1 1 auto;
      width: 100%;
      height: 100%;
      border-radius: 12px;
      overflow: hidden;
      position: relative;
        padding-right: 2px; /* avoid kissing the insights scrollbar visually */
    }
  /* Make insights panel flexible so its content grows/shrinks with resize */
  #insights-panel { display: flex; flex-direction: column; height: 480px; }
  #insights-content { flex: 1 1 auto; min-height: 0; }
  #timeline-panel { height: 320px; }
    #leaflet-map {
      width: 100%;
      height: 100%;
      border-radius: 12px;
      position: absolute;
      top: 0;
      left: 0;
    }
  /* Make timeline panel content flex so height resize is meaningful */
  #timeline-panel { display: flex; flex-direction: column; }
  #timeline-panel .filmstrip { flex: 1 1 auto; min-height: 0; }
  /* Year slider row */
  .year-row { display: flex; align-items: center; gap: 8px; }
  .year-end { font-size: 12px; color: #cbd5e1; opacity: 0.8; min-width: 34px; text-align: center; }
  .year-slider-wrap { position: relative; flex: 1 1 auto; }
  #year-slider { width: 100%; }
  .year-tooltip { position: absolute; top: -18px; left: 50%; transform: translateX(-50%); background: rgba(2,6,23,0.85); color: #fbbf24; font-size: 11px; padding: 2px 6px; border-radius: 999px; border: 1px solid rgba(251,191,36,0.35); pointer-events: none; white-space: nowrap; }
  .mobile-dock { display: none; }
  .cat-dock { display: none; }
  .insights-chip { display: none; }
  /* Desktop strip hidden by default in global, shown via media queries */
  .desktop-pre-strip { display: none; }
  /* Overlay hidden by default */
  .page-overlay { display: none !important; position: fixed; inset: 0; z-index: 1200; }
  .page-overlay.show { display: block !important; }
  .page-overlay .overlay-header { display: none; }
  .page-overlay .overlay-body { display: none; }

  /* Responsive: stack panels and simplify on small screens */
  @media (max-width: 768px) {
    .draggable { cursor: default; }
    #left-panel, #map-panel, #insights-panel, #timeline-panel {
      position: static !important;
      width: 100% !important;
      min-width: 0 !important;
      max-width: none !important;
      left: auto !important;
      right: auto !important;
      top: auto !important;
      margin: 12px 0;
    }
    #map-panel { height: auto; }
    #map-container { height: 320px; }
    #insights-panel { height: auto; }
    #timeline-panel { height: auto; }
    .resize-handle { display: none !important; }
    .panel { padding: 16px 14px; }
  }

  /* Compact grid (phones in landscape / small tablets): keep all panels visible */
  @media (min-width: 481px) and (max-width: 900px) {
  /* Show desktop strip in compact mode */
  .desktop-pre-strip { display: flex !important; align-items: center; gap: 8px; padding: 6px 8px; margin: 6px 0 10px 0; border-radius: 12px; border:1px solid rgba(255,255,255,0.07); background: rgba(30,41,59,0.85); box-shadow: 0 4px 14px rgba(0,0,0,0.18); position: sticky; top: 6px; z-index: 1500; width: 100%; box-sizing: border-box; }
  .desktop-pre-strip .mps-title { font-weight: 900; font-size: 12px; letter-spacing: .3px; color:#fbbf24; text-transform: uppercase; margin-right: 8px; }
  .desktop-pre-strip .mps-title-link { display:inline-flex; align-items:center; gap:6px; padding: 4px 10px; border-radius: 999px; border: 2px solid #fbbf24; color:#fbbf24; text-decoration:none; }
  .desktop-pre-strip .mps-actions { display:flex; align-items:center; gap: 6px; }
  .desktop-pre-strip .mps-btn { font-size: 11px; padding: 4px 10px; border-radius: 999px; border:1px solid #475569; background: rgba(2,6,23,0.72); color:#e5e7eb; text-decoration: none; }
  .desktop-pre-strip .mps-btn:hover { filter: brightness(1.06); }
    #app {
  /* Make room for strip above grid */
  margin-top: 0;
      display: grid;
      grid-template-columns: 84px 1fr 280px;
      grid-template-rows: auto 1fr 220px;
      gap: 12px;
      align-items: stretch;
    }
    #left-panel, #map-panel, #insights-panel, #timeline-panel {
      position: static !important;
      margin: 0 !important;
      width: auto !important;
    }
    #left-panel { grid-column: 1; grid-row: 1 / 4; overflow: auto; }
    #map-panel { grid-column: 2; grid-row: 1 / 3; height: auto; }
    #insights-panel { grid-column: 3; grid-row: 1 / 3; height: auto; }
    #timeline-panel { grid-column: 1 / 4; grid-row: 3; height: auto; }
  .year-end { font-size: 11px; }

  /* Compact category list */
  #left-panel .category { padding: 6px 8px; font-size: 12px; margin-bottom: 4px; white-space: nowrap; overflow: hidden; text-overflow: ellipsis; }
    #left-panel .brand-header { display:none; }
  }

  /* Show overlay layout on desktop/tablet as well */
  @media (min-width: 481px) {
    .page-overlay.show {
      display: block !important;
      padding: 8px;
      background: linear-gradient(120deg, rgba(15,23,42,0.98) 60%, rgba(30,41,59,0.98) 100%);
    }
    .page-overlay .overlay-header { display: none !important; }
    .page-overlay .overlay-body { display: block !important; height: calc(100dvh - 16px); }
    .overlay-card {
      height: 100% !important;
      border-radius: 12px;
      border:1px solid rgba(255,255,255,0.07);
      background: rgba(30,41,59,0.85);
      box-shadow: 0 4px 14px rgba(0,0,0,0.18);
    }
    /* Larger readable overlay text on desktop/tablet */
    .overlay-content { padding: 14px 16px !important; }
    .overlay-title { font-size: 16px !important; }
    .overlay-copy { font-size: 14px !important; line-height: 1.5 !important; }
    .overlay-link { font-size: 14px !important; }
  }

  /* Wide desktop: show the top strip and keep it sticky/visible */
  @media (min-width: 901px) {
    .desktop-pre-strip {
      display: flex !important;
      align-items: center;
      gap: 8px;
      padding: 6px 8px;
      margin: 8px 0 12px 0;
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.07);
      background: rgba(30,41,59,0.85);
      box-shadow: 0 4px 14px rgba(0,0,0,0.18);
      position: sticky;
      top: 6px;
      z-index: 1500;
      width: 100%;
      box-sizing: border-box;
    }
  .desktop-pre-strip .mps-title {
      font-weight: 900;
      font-size: 12px;
      letter-spacing: .3px;
      color: #fbbf24;
      text-transform: uppercase;
      margin-right: 8px;
    }
  .desktop-pre-strip .mps-title-link { display:inline-flex; align-items:center; gap:6px; padding: 4px 10px; border-radius: 999px; border: 2px solid #fbbf24; color:#fbbf24; text-decoration:none; }
    .desktop-pre-strip .mps-actions {
      display: flex;
      align-items: center;
      gap: 6px;
    }
    .desktop-pre-strip .mps-btn {
      font-size: 11px;
      padding: 4px 10px;
      border-radius: 999px;
      border: 1px solid #475569;
      background: rgba(2,6,23,0.72);
      color: #e5e7eb;
      text-decoration: none;
    }
    .desktop-pre-strip .mps-btn:hover { filter: brightness(1.06); }
    .desktop-pre-strip .mps-btn.active {
      background: #fbbf24;
      color: #0b1220;
      border-color: #f59e0b;
      box-shadow: 0 0 0 2px rgba(251,191,36,0.28) inset;
    }
  }

  /* Phone portrait: compact 2-col grid; categories move to a horizontal dock over the map */
  @media (max-width: 480px) {
  /* Hide desktop strip on phones */
  .desktop-pre-strip { display: none !important; }
    /* Allow natural page height and scrolling so the timeline isn't crammed at the bottom */
    html, body { height: auto !important; min-height: 100dvh; }
    #app { min-height: 100dvh; }
    body { overflow: auto !important; }
  :root { --mstrip-h: 28px; }
    #app {
      padding: 2px 2px 8px !important;  /* a bit more bottom padding for breathing room */
      display: grid;
      grid-template-columns: 1fr 140px;     /* map left, insights right (wider) */
      /* Rows: top placeholder strip, then main row, then timeline */
      grid-template-rows: var(--mstrip-h) auto clamp(160px, 26vh, 260px);
      gap: 6px;
  align-items: stretch; /* stretch items to row height so Insights fills the first row */
    }
  /* New phone-only top strip spanning both columns */
    .mobile-pre-strip {
      display: block !important;
      grid-column: 1 / 3;
      grid-row: 1;
      height: var(--mstrip-h);
      border-radius: 12px;
      border: 1px solid rgba(255,255,255,0.07);
      background: rgba(30,41,59,0.85);
      box-shadow: 0 4px 14px rgba(0,0,0,0.18);
      display: flex !important;
      align-items: center;
      justify-content: flex-start;
      gap: 6px;
      padding: 2px 6px;
    }
  .mps-title { font-weight: 900; font-size: 11px; letter-spacing: .3px; color:#fbbf24; text-transform: uppercase; margin-right: 4px; }
  .mps-title-link { display:inline-flex; align-items:center; gap:6px; padding: 2px 8px; border-radius: 999px; border: 2px solid #fbbf24; color:#fbbf24; text-decoration:none; }
    .mps-actions { display:flex; align-items:center; gap: 4px; overflow-x: auto; }
    .mps-actions::-webkit-scrollbar { height: 4px; }
    .mps-actions::-webkit-scrollbar-thumb { background: rgba(148,163,184,0.5); border-radius: 999px; }
    .mps-btn { flex: 0 0 auto; font-size: 10px; line-height: 1.1; padding: 3px 8px; border-radius: 999px; border:1px solid #475569; background: rgba(2,6,23,0.72); color: #e5e7eb; text-decoration: none; }
    .mps-btn:hover { filter: brightness(1.06); }
    .mps-btn:active { transform: translateY(1px); }
  .mps-btn.active { background:#fbbf24; color:#0b1220; border-color:#f59e0b; box-shadow: 0 0 0 2px rgba(251,191,36,0.28) inset; }
  /* Phone overlay styles */
  .page-overlay { display: none; position: fixed; inset: 0; z-index: 1200; }
  .page-overlay.show { display: grid; grid-template-rows: var(--mstrip-h) 1fr; gap: 6px; padding: 2px; background: linear-gradient(120deg, rgba(15,23,42,0.98) 60%, rgba(30,41,59,0.98) 100%); }
  .page-overlay .overlay-header { display: flex; align-items: center; justify-content: flex-start; gap: 6px; padding: 2px 6px; border-radius: 12px; border: 1px solid rgba(255,255,255,0.07); background: rgba(30,41,59,0.92); }
  .page-overlay .overlay-body { display: block; }
  .overlay-card { height: 100%; border-radius: 12px; border:1px solid rgba(255,255,255,0.07); background: rgba(30,41,59,0.85); box-shadow: 0 4px 14px rgba(0,0,0,0.18); }
    /* Place panels into grid */
    #left-panel, #map-panel, #insights-panel, #timeline-panel {
      position: static !important;
      margin: 0 !important;
      width: auto !important;
      max-width: none !important;
      top: auto !important; left: auto !important; right: auto !important; bottom: auto !important;
      box-shadow: none; /* flatter on phone */
      padding: 4px 4px; /* even tighter padding */
    }
    #left-panel { display: none !important; }
  #map-panel { grid-column: 1; grid-row: 2; height: auto !important; display: block; min-height: 0; padding: 2px 2px 0 2px; align-self: start; position: relative; }
  /* Show brand/contact row only on phone, space it below the map */
  .brand-row { display: flex; margin: 4px 0 2px 0; }
  .brand-logo { font-size: 12px; }
  .brand-badge { font-size: 11px; gap:5px; padding: 2px 6px; }
  .brand-badge img { width:14px; height:14px; }
  .contact-tab { font-size: 9.5px; padding: 3px 8px; }
  /* Insights: stretch to map row height; slightly taller via JS with negative margin to avoid pushing row */
  #insights-panel { grid-column: 2; grid-row: 2; display:flex; flex-direction: column; overflow: hidden; min-height: 0; align-self: stretch; height: auto; max-height: clamp(240px, 36vh, 360px); position: relative; z-index: 5; }
  /* Timeline: occupy the taller second row, remove negative offset, and give it its own height */
  #timeline-panel { grid-column: 1 / 3; grid-row: 3; display:flex; flex-direction: column; overflow: hidden; height: 100%; min-height: clamp(140px, 24vh, 240px); margin-top: -6px; z-index: 6; padding-bottom: max(8px, env(safe-area-inset-bottom, 0)); }

    /* Map should fill its cell */
  /* Map and container behave like a single unit sized by content */
  #map-container { width: 100%; height: auto !important; display: flex; flex-direction: column; position: relative; }
  #leaflet-map { position: relative !important; top: auto !important; left: auto !important; width: 100%; height: clamp(200px, 34vh, 340px) !important; }
  /* Make Leaflet controls smaller so they take less visual space */
  .leaflet-control { margin: 4px; }
  .leaflet-control-zoom { transform: scale(0.82); transform-origin: top left; }
  .leaflet-control-attribution { font-size: 9px; }

  /* Smaller Leaflet popup on phones (only bb-popup) */
  .bb-popup .leaflet-popup-content-wrapper {
    padding: 2px 4px; border-radius: 8px; max-width: 160px;
    background: rgba(2,6,23,0.98);
    color: #e5e7eb;
    border: 1px solid #334155;
    box-shadow: 0 6px 18px rgba(0,0,0,0.5);
  }
  /* Desktop/tablet >= 901px */
  @media (min-width: 901px) {
  .desktop-pre-strip { display: flex !important; align-items: center; gap: 10px; padding: 8px 10px; margin: 10px 0 14px 0; border-radius: 14px; border:1px solid rgba(255,255,255,0.07); background: rgba(30,41,59,0.85); box-shadow: 0 6px 16px rgba(0,0,0,0.22); position: sticky; top: 8px; z-index: 1500; width: 100%; box-sizing: border-box; }
    .desktop-pre-strip .mps-title { font-weight: 900; font-size: 13px; letter-spacing: .35px; color:#fbbf24; text-transform: uppercase; margin-right: 10px; }
    .desktop-pre-strip .mps-actions { display:flex; align-items:center; gap: 8px; }
    .desktop-pre-strip .mps-btn { font-size: 12px; padding: 6px 12px; border-radius: 999px; border:1px solid #475569; background: rgba(2,6,23,0.72); color:#e5e7eb; text-decoration: none; }
    .desktop-pre-strip .mps-btn:hover { filter: brightness(1.06); }
  }
  .bb-popup .leaflet-popup-content { margin: 1px 0; font-size: 8.5px; line-height: 1.2; max-height: 88px; overflow: auto; word-wrap: break-word; overflow-wrap: anywhere; }
  .bb-popup .leaflet-popup-content p, .bb-popup .leaflet-popup-content li { font-size: 8.5px; line-height: 1.2; }
  .bb-popup .leaflet-popup-content h1, .bb-popup .leaflet-popup-content h2, .bb-popup .leaflet-popup-content h3 { font-size: 9.5px; margin: 1px 0; }
  .bb-popup .leaflet-popup-tip { width: 6px; height: 6px; background: rgba(2,6,23,0.98); border: 1px solid #334155; }
  .leaflet-container a.leaflet-popup-close-button { font-size: 12px; color: #cbd5e1; }
  /* Phone overrides for structured inner content */
  .bb-popup .bbp { font-size: 8.5px; }
  .bb-popup .bbp .bb-title { font-size: 9.5px; }
  .bb-popup .bbp .bb-meta { font-size: 8.5px; }
  .bb-popup .bbp .bb-summary { font-size: 8.5px; }
  .marker-cluster div { font-size: 10px; }

  /* Any general button overlays inside map (e.g., Fit) */
  #map-container button { font-size: 10px; padding: 3px 6px; border-radius: 10px; }
  /* (global popup styles are defined outside this media query; keep phone overrides above) */

  /* Horizontal category dock over the map */
  .cat-dock { display:flex !important; position: static !important; margin: 1px 1px 3px 1px; gap:2px; padding: 0 2px; overflow-x: auto; }
  .cat-dock::-webkit-scrollbar { height: 4px; }
  .cat-dock::-webkit-scrollbar-thumb { background: rgba(148,163,184,0.55); border-radius: 999px; }
  .cat-dock .cat-btn { flex: 0 0 auto; font-size: 8px; line-height: 1.1; padding: 2px 5px; border-radius: 999px; border:1px solid #475569; background: rgba(2,6,23,0.72); color: #e5e7eb; }
  .cat-dock .cat-btn.active { background:#fbbf24; color:#0b1220; border-color:#f59e0b; }

    /* Insights content scrolls internally */
  #insights-panel { height: auto !important; max-height: clamp(240px, 36vh, 360px) !important; align-self: stretch !important; }
  #insights-content { flex: 1 1 auto; min-height: 0; overflow: auto; }

    /* Category list: full words, small, scrollable */
  #left-panel .brand-header { display: none; }
    #left-panel .category {
      font-size: 8px; padding: 3px 4px; margin-bottom: 3px; /* denser when vertical on very small screens */
      white-space: nowrap; overflow: hidden; text-overflow: ellipsis; line-height: 1.1;
    }

  /* Hide most headings on phone to reclaim height */
  #map-panel h2, #insights-panel h2, #timeline-panel h2 { display:none; }
  #left-panel h2 { font-size: 10px; margin-bottom: 2px; }

    /* Filmstrip + slider compact but not too tall */
  .filmstrip { padding: 3px; gap: 5px; min-height: 60px; }
  .event-chip { padding: 5px; min-width: 100px; }
  /* Filmstrip titles: match insights title feel (less bold, a bit larger for clarity) */
  .chip-title { font-size: 10px; line-height: 1.25; font-weight: 600; }
  .chip-summary, .chip-tags { display:none !important; }
  #year-slider { height: 12px; margin-top: 2px; margin-bottom: 2px; }
  .year-readout { font-size: 10.5px; }

  /* Place the year slider at the top of the timeline panel */
  #timeline-panel #year-row { order: -1; }
  .year-end { font-size: 9px; min-width: 26px; }
  .year-tooltip { top: -14px; font-size: 9px; }

  /* Thin, compact range slider */
  #year-slider { appearance: none; background: transparent; }
  #year-slider::-webkit-slider-runnable-track { height: 2px; background: #475569; border-radius: 999px; }
  #year-slider::-moz-range-track { height: 2px; background: #475569; border-radius: 999px; }
  #year-slider::-ms-track { height: 2px; background: transparent; border-color: transparent; color: transparent; }
  #year-slider::-ms-fill-lower, #year-slider::-ms-fill-upper { background: #475569; border-radius: 999px; }
  #year-slider::-webkit-slider-thumb { -webkit-appearance: none; width: 14px; height: 14px; background: #fbbf24; border-radius: 50%; border: 2px solid #1e293b; margin-top: -6px; }
  #year-slider::-moz-range-thumb { width: 14px; height: 14px; background: #fbbf24; border: 2px solid #1e293b; border-radius: 50%; }
  #year-slider::-ms-thumb { width: 14px; height: 14px; background: #fbbf24; border: 2px solid #1e293b; border-radius: 50%; }

  /* Insights text smaller (more dense) */
  .ins-card { padding: 4px 4px; }
  .ins-title { font-size: 10px; line-height: 1.25; display:-webkit-box; -webkit-line-clamp: 2; line-clamp: 2; -webkit-box-orient: vertical; overflow:hidden; }
  .ins-summary, .ins-extra { font-size: 9.5px; line-height: 1.25; display:block !important; color:#cbd5e1; }
  .ins-summary { display:-webkit-box; -webkit-line-clamp: 5; line-clamp: 5; -webkit-box-orient: vertical; overflow:hidden; }
  .ins-tagline, .ins-tab { font-size: 9px; }
  .ins-tabs { overflow-x: auto; white-space: nowrap; gap: 4px; padding-bottom: 2px; }
  .ins-tab { padding: 2px 6px; border-radius: 999px; }
  /* Filmstrip year pill a touch smaller on phone */
  .chip-year { font-size: 9px; }
  /* Hide any large media inside insights on phones */
  #insights-panel img, #insights-panel video, #insights-panel iframe { display:none !important; }
  .ins-tagline { font-size: 9px; }
  .ins-tab { font-size: 9.5px; padding: 2px 5px; }

  /* Hide bottom micro-dock and insights chip in this mode */
  .mobile-dock, .insights-chip { display: none !important; }
  }
    </style>
    
    <!-- Navigation Script - Execute after DOM is loaded -->
    <script>
    console.log('Navigation script loading...');
    
    // Simple hash router for overlays
    function initNavigation() {
      console.log('Initializing navigation system...');
      
      const pageOverlay = document.getElementById('page-overlay');
      const overlayCanvas = document.getElementById('overlay-canvas');
      
      if (!pageOverlay || !overlayCanvas) {
        console.error('Required elements not found:', { pageOverlay, overlayCanvas });
        return;
      }
      
      console.log('Elements found successfully');
      
      // Global state
      let currentContinent = 'World';
      let currentYear = 1973;
      let fafoData = [];

      // Load FAFO data
      async function loadFAFOData() {
        console.log('🔄 Starting to load FAFO data...');
        try {
          console.log('📡 Fetching from: /src/data/fafo_new.json');
          const response = await fetch('/src/data/fafo_new.json');
          console.log('📡 Response status:', response.status, response.statusText);
          
          if (!response.ok) {
            throw new Error(`HTTP error! status: ${response.status}`);
          }
          
          fafoData = await response.json();
          console.log('✅ FAFO data loaded successfully!');
          console.log('📊 Data contains', fafoData.length, 'events');
          console.log('📋 First event:', fafoData[0]);
          
          // Trigger initial panel update
          updatePanels();
        } catch (error) {
          console.error('❌ Error loading FAFO data:', error);
          console.error('📍 Full error details:', error.message);
          
          // Show error in panels
          updatePanelContent('fa-panel', `
            <h4 style="color:#f87171; text-align:center;">Error Loading Data</h4>
            <p style="color:#e2e8f0; text-align:center;">Failed to load FAFO data: ${error.message}</p>
          `);
        }
      }

      // Global function for continent selection
      window.selectContinent = function(continent) {
        console.log('Selected continent:', continent);
        currentContinent = continent;
        
        // Add visual feedback
        event.target.style.background = 'rgba(52,211,153,0.3)';
        event.target.style.borderColor = '#34d399';
        setTimeout(() => {
          event.target.style.background = 'rgba(15,23,42,0.8)';
          event.target.style.borderColor = '#475569';
        }, 300);

        // Update panels with filtered data
        updatePanels();
      };

      // Update year from slider
      window.updateYear = function(year) {
        currentYear = parseInt(year);
        console.log('Year changed to:', currentYear);
        
        // Update year display
        const yearDisplay = document.getElementById('current-year');
        if (yearDisplay) {
          yearDisplay.textContent = currentYear;
        }
        
        // Update panels with filtered data
        updatePanels();
      };

      // Filter data based on current continent and year
      function getFilteredData() {
        let filtered = fafoData;

        // Filter by continent (World shows all)
        if (currentContinent !== 'World') {
          filtered = filtered.filter(event => event.continent === currentContinent);
        }

        // Filter by year
        filtered = filtered.filter(event => event.year === currentYear);

        return filtered[0] || null; // Return first match or null
      }

      // Update all three panels with current data
      function updatePanels() {
        const data = getFilteredData();
        
        if (!data) {
          // No data found - show placeholder
          updatePanelContent('fa-panel', `<div class="p-6">
            <h3 class="text-lg font-semibold text-white mb-4">No FA Event Found</h3>
            <p class="text-gray-300">No events found for ${currentContinent} in ${currentYear}</p>
          </div>`);
          
          updatePanelContent('middle-panel', `<div class="p-6">
            <h3 class="text-lg font-semibold text-white mb-4">No Middle Man</h3>
            <p class="text-gray-300">No quotes available</p>
          </div>`);
          
          updatePanelContent('fo-panel', `<div class="p-6">
            <h3 class="text-lg font-semibold text-white mb-4">No FO Fallout</h3>
            <p class="text-gray-300">No fallout data available</p>
          </div>`);
          return;
        }

        // Update FA Panel
        updatePanelContent('fa-panel', `
          <h3 style="margin:0 0 16px 0; font-size:16px; font-weight:700; color:#fbbf24; text-align:center;">FA - ${data.year} (${data.continent})</h3>
          <p style="color:#cbd5e1; line-height:1.6; margin:0;">${data.fa}</p>
        `);

        // Update Middle Panel  
        updatePanelContent('middle-panel', `
          <h3 style="margin:0 0 16px 0; font-size:16px; font-weight:700; color:#a78bfa; text-align:center;">Middle Man</h3>
          <div style="text-align:center; margin-bottom:16px;">
            <img src="${data.middle.image}" alt="${data.middle.actor}" style="width:60px; height:60px; border-radius:50%; margin:0 auto 12px auto; object-fit:cover; display:block;" onerror="this.src='data:image/svg+xml;base64,PHN2ZyB3aWR0aD0iNjAiIGhlaWdodD0iNjAiIHZpZXdCb3g9IjAgMCA2MCA2MCIgZmlsbD0ibm9uZSIgeG1sbnM9Imh0dHA6Ly93d3cudzMub3JnLzIwMDAvc3ZnIj4KPHJlY3Qgd2lkdGg9IjYwIiBoZWlnaHQ9IjYwIiByeD0iMzAiIGZpbGw9IiM0Yjc3YmUiLz4KPHN2ZyB3aWR0aD0iMzAiIGhlaWdodD0iMzAiIHZpZXdCb3g9IjAgMCAzMCAzMCIgeD0iMTUiIHk9IjE1IiBmaWxsPSJ3aGl0ZSI+CjxwYXRoIGQ9Ik0xNSAxNUM0LjkgMTUgMCAxNS4xIDAgOVMgNC45IDIgMTUgMlMgMzAgNC45IDMwIDlTMjUuMSAxNSAxNSAxNVoiLz4KPC9zdmc+Cjwvc3ZnPic=" />
            <p style="color:#e2e8f0; font-weight:600; margin:0; font-size:14px;">${data.middle.actor}</p>
          </div>
          <blockquote style="color:#fde047; font-style:italic; text-align:center; line-height:1.5; margin:0; padding:0; font-size:14px;">
            ${data.middle.quote}
          </blockquote>
        `);

        // Update FO Panel
        updatePanelContent('fo-panel', `
          <h3 style="margin:0 0 16px 0; font-size:16px; font-weight:700; color:#f87171; text-align:center;">FO - The Fallout</h3>
          <p style="color:#fca5a5; line-height:1.6; margin:0 0 16px 0; font-size:14px;">${data.fo}</p>
          <div style="display:flex; flex-wrap:wrap; gap:6px; justify-content:center;">
            ${data.tags.map(tag => `<span style="padding:4px 8px; background:rgba(185,28,28,0.3); color:#fca5a5; border-radius:12px; font-size:11px; font-weight:500;">${tag}</span>`).join('')}
          </div>
        `);
      }

      // Helper function to update panel content
      function updatePanelContent(panelId, content) {
        const panel = document.getElementById(panelId);
        if (panel) {
          panel.innerHTML = content;
        }
      }

      // Render overlay content
      function renderOverlay(route) {
        console.log('Rendering overlay for route:', route);
        if (route === 'fa-goals') {
          overlayCanvas.innerHTML = `
            <div class="overlay-content" style="padding:20px; height:100%; display:flex; flex-direction:column; gap:16px;">
              <h3 style="margin:0; font-size:18px; font-weight:800; color:#fbbf24; text-align:center;">FA/FO Goals & Bills</h3>
              
              <!-- Top horizontal panel: Continents -->
              <div style="background:rgba(30,41,59,0.85); border:1px solid #334155; border-radius:12px; padding:16px;">
                <h4 style="margin:0 0 12px 0; font-size:14px; font-weight:700; color:#34d399; text-align:center;">Continents</h4>
                <div style="display:flex; flex-wrap:wrap; gap:8px; justify-content:center;">
                  <button type="button" onclick="selectContinent('World')" style="background:rgba(15,23,42,0.8); border:1px solid #475569; border-radius:6px; padding:6px 12px; color:#e2e8f0; font-size:12px; min-width:120px; cursor:pointer; transition:all 0.2s;" onmouseover="this.style.background='rgba(30,41,59,0.9)'; this.style.borderColor='#64748b';" onmouseout="this.style.background='rgba(15,23,42,0.8)'; this.style.borderColor='#475569';">World</button>
                  <button type="button" onclick="selectContinent('North America')" style="background:rgba(15,23,42,0.8); border:1px solid #475569; border-radius:6px; padding:6px 12px; color:#e2e8f0; font-size:12px; min-width:120px; cursor:pointer; transition:all 0.2s;" onmouseover="this.style.background='rgba(30,41,59,0.9)'; this.style.borderColor='#64748b';" onmouseout="this.style.background='rgba(15,23,42,0.8)'; this.style.borderColor='#475569';">North America</button>
                  <button type="button" onclick="selectContinent('South America')" style="background:rgba(15,23,42,0.8); border:1px solid #475569; border-radius:6px; padding:6px 12px; color:#e2e8f0; font-size:12px; min-width:120px; cursor:pointer; transition:all 0.2s;" onmouseover="this.style.background='rgba(30,41,59,0.9)'; this.style.borderColor='#64748b';" onmouseout="this.style.background='rgba(15,23,42,0.8)'; this.style.borderColor='#475569';">South America</button>
                  <button type="button" onclick="selectContinent('Europe')" style="background:rgba(15,23,42,0.8); border:1px solid #475569; border-radius:6px; padding:6px 12px; color:#e2e8f0; font-size:12px; min-width:120px; cursor:pointer; transition:all 0.2s;" onmouseover="this.style.background='rgba(30,41,59,0.9)'; this.style.borderColor='#64748b';" onmouseout="this.style.background='rgba(15,23,42,0.8)'; this.style.borderColor='#475569';">Europe</button>
                  <button type="button" onclick="selectContinent('Asia')" style="background:rgba(15,23,42,0.8); border:1px solid #475569; border-radius:6px; padding:6px 12px; color:#e2e8f0; font-size:12px; min-width:120px; cursor:pointer; transition:all 0.2s;" onmouseover="this.style.background='rgba(30,41,59,0.9)'; this.style.borderColor='#64748b';" onmouseout="this.style.background='rgba(15,23,42,0.8)'; this.style.borderColor='#475569';">Asia</button>
                  <button type="button" onclick="selectContinent('Africa')" style="background:rgba(15,23,42,0.8); border:1px solid #475569; border-radius:6px; padding:6px 12px; color:#e2e8f0; font-size:12px; min-width:120px; cursor:pointer; transition:all 0.2s;" onmouseover="this.style.background='rgba(30,41,59,0.9)'; this.style.borderColor='#64748b';" onmouseout="this.style.background='rgba(15,23,42,0.8)'; this.style.borderColor='#475569';">Africa</button>
                  <button type="button" onclick="selectContinent('Australia')" style="background:rgba(15,23,42,0.8); border:1px solid #475569; border-radius:6px; padding:6px 12px; color:#e2e8f0; font-size:12px; min-width:120px; cursor:pointer; transition:all 0.2s;" onmouseover="this.style.background='rgba(30,41,59,0.9)'; this.style.borderColor='#64748b';" onmouseout="this.style.background='rgba(15,23,42,0.8)'; this.style.borderColor='#475569';">Australia</button>
                  <button type="button" onclick="selectContinent('Antarctica')" style="background:rgba(15,23,42,0.8); border:1px solid #475569; border-radius:6px; padding:6px 12px; color:#e2e8f0; font-size:12px; min-width:120px; cursor:pointer; transition:all 0.2s;" onmouseover="this.style.background='rgba(30,41,59,0.9)'; this.style.borderColor='#64748b';" onmouseout="this.style.background='rgba(15,23,42,0.8)'; this.style.borderColor='#475569';">Antarctica</button>
                  <button type="button" onclick="selectContinent('Middle East')" style="background:rgba(15,23,42,0.8); border:1px solid #475569; border-radius:6px; padding:6px 12px; color:#e2e8f0; font-size:12px; min-width:120px; cursor:pointer; transition:all 0.2s;" onmouseover="this.style.background='rgba(30,41,59,0.9)'; this.style.borderColor='#64748b';" onmouseout="this.style.background='rgba(15,23,42,0.8)'; this.style.borderColor='#475569';">Middle East</button>
                </div>
              </div>

              <!-- Main three panels -->
              <div style="display:flex; gap:20px; flex:1;">
                <div id="fa-panel" style="flex:1; background:rgba(30,41,59,0.85); border:1px solid #334155; border-radius:12px; padding:20px;">
                  <h4 style="color:#fbbf24; text-align:center;">FA Goals</h4>
                  <p style="color:#e2e8f0;">Click a continent and adjust the year to see events...</p>
                </div>
                <div id="middle-panel" style="flex:1; background:rgba(30,41,59,0.85); border:1px solid #334155; border-radius:12px; padding:20px;">
                  <h4 style="color:#a78bfa; text-align:center;">Middle Man</h4>
                  <p style="color:#e2e8f0;">Quotes from historical figures...</p>
                </div>
                <div id="fo-panel" style="flex:1; background:rgba(30,41,59,0.85); border:1px solid #334155; border-radius:12px; padding:20px;">
                  <h4 style="color:#f87171; text-align:center;">FO - Fallout</h4>
                  <p style="color:#e2e8f0;">The savage aftermath...</p>
                </div>
              </div>

              <!-- Bottom horizontal panel: Year Slider -->
              <div style="background:rgba(30,41,59,0.85); border:1px solid #334155; border-radius:12px; padding:16px;">
                <h4 style="margin:0 0 12px 0; font-size:14px; font-weight:700; color:#c084fc; text-align:center;">Year Range (1900 - 2025)</h4>
                <p style="margin:0 0 8px 0; font-size:11px; color:#94a3b8; text-align:center;">📅 Data available for: 1910, 1947, 1953, 1973, 1994</p>
                <div style="display:flex; align-items:center; gap:12px;">
                  <span style="color:#cbd5e1; font-size:12px;">1900</span>
                  <input type="range" min="1900" max="2025" value="1973" id="year-slider" oninput="updateYear(this.value)" style="flex:1;" />
                  <span style="color:#cbd5e1; font-size:12px;">2025</span>
                  <span id="current-year" style="color:#22c55e; font-weight:bold; margin-left:8px;">1973</span>
                </div>
              </div>
            </div>
          `;
          
          // Load FAFO data after DOM is ready
          setTimeout(() => {
            console.log('🚀 DOM ready, loading FAFO data...');
            loadFAFOData();
          }, 100);
          
        } else if (route === 'buildbyer') {
          overlayCanvas.innerHTML = '<div style="padding: 20px; color: white;"><h3>BuildByer Info</h3><p>BuildByer information would go here.</p></div>';
        }
      }
      
      // Route function
      function route() {
        const hash = location.hash;
        console.log('Routing to:', hash);
        
        if (hash === '#fa-goals') {
          pageOverlay.classList.add('show');
          renderOverlay('fa-goals');
        } else if (hash === '#buildbyer') {
          pageOverlay.classList.add('show');
          renderOverlay('buildbyer');
        } else {
          pageOverlay.classList.remove('show');
        }
      }
      
      // Set up event listeners
      document.querySelectorAll('a[href^="#"]').forEach(link => {
        link.addEventListener('click', function(e) {
          const href = this.getAttribute('href');
          if (href === '#fa-goals' || href === '#buildbyer') {
            e.preventDefault();
            location.hash = href;
            route();
          }
        });
      });
      
      // Listen for hash changes
      window.addEventListener('hashchange', route);
      
      // Initial route
      route();
      
      console.log('Navigation initialization complete!');
    }
    
    // Initialize when page loads
    if (document.readyState === 'loading') {
      document.addEventListener('DOMContentLoaded', initNavigation);
    } else {
      initNavigation();
    }
    </script>
  </body>
</html>
